# Assignment 3
Author: *Sinclair DeYoung*

---
### Chapter_3L binary samples
**1. Advantages of Dynamic Malware Analysis Over Static Analysis**

1. Observes real-time malware behavior.
2. Detects hidden or obfuscated code.
3. Reveals network activity.
4. Identifies system modifications (registry changes, file creation).
5. Tracks process execution.

**2. Dynamic Malware Analysis and Sandbox Tools**
*Research Tools*
- Cuckoo Sandbox
    - Drawbacks:
        - *Resource-intensive:* Requires a lot of system resources (CPU, RAM) for setup and analysis.
        - *Limited evasion detection:* Malware can sometimes detect the sandbox environment, leading to inaccurate results.
        - *Manual configuration:* Requires significant configuration and maintenance effort, particularly for additional modules (network, memory).
        - *Lacks scalability:* Not as scalable for larger enterprises without major adjustments.
- Any.run
    - Drawbacks
        - *Web-based limitations:* Being an online platform, it may not handle large or complex malware samples well.
        - *Limited customization:* Fewer customization options compared to on-premise sandboxes like Cuckoo.
        - *Privacy concerns:* Sending malware samples to an online platform can raise privacy and confidentiality concerns.
        - *Limited free version:* Certain features are locked behind a paywall, limiting comprehensive analysis.
- Hybrid Analysis
    - Drawbacks
        - *Evasion tactics:* Advanced malware may recognize the Hybrid Analysis environment and refuse to execute properly.
        - *Delayed reports:* Complex analysis can take longer, slowing down real-time detection.
        - *Privacy concerns:* Uploading sensitive or custom malware samples to a public platform could be risky.
Limited manual control: Users have less control over the analysis environment.
- Joe Sandbox
    - Drawbacks
        - *High cost:* Joe Sandbox is quite expensive, especially for smaller organizations or individual users.
        - *Complex configuration:* Requires detailed setup and configuration for optimal performance.
        - *Evasion vulnerabilities:* Advanced malware might evade detection by recognizing sandbox behavior.
- FireEye (now Trellix) Sandbox
    - Drawbacks
        - *Costly enterprise tool:* Expensive, making it more suitable for large organizations than small ones.
        - *Resource-heavy:* Requires significant hardware resources to operate effectively.
        - *Limited to FireEye ecosystem:* Tied closely with FireEye's ecosystem, which can limit flexibility for those using multiple vendor solutions.
- VxStream Sandbox
    - Drawbacks
        - *High cost:* VxStream is more geared towards enterprises, making it expensive for individual users or small businesses.
        - *Limited free access:* The free version provides restricted access and limited results compared to paid tiers.
        - *Complex interface:* Some users report a steep learning curve in navigating the interface and utilizing advanced features.
- ThreatAnalyzer
    - Drawbacks
        - *Expensive:* Similar to FireEye, ThreatAnalyzer is costly, making it less accessible to smaller organizations.
        - *Steep learning curve:* Requires expertise and familiarity with malware analysis techniques to get the most out of the tool.
        - *Performance lag:* Some users have reported lag during malware execution and report generation.
- GFI Sandbox
    - Drawbacks
        - *Aging technology:* GFI Sandbox is somewhat outdated compared to newer competitors, which might not keep up with advanced malware techniques.
        - *Lack of updates:* The platform may not receive frequent updates, limiting its effectiveness against the latest malware.
        - *Not user-friendly:* The interface and workflow can be difficult to navigate for beginners.
- Cape Sandbox
    - Drawbacks
        - *Complex configuration:* Like Cuckoo, it requires a lot of manual configuration and customization.
        - *Performance limitations:* Slower performance when handling large or complex samples.
        - *Evasion risks:* Some malware can detect the sandbox and behave differently, making analysis less reliable.

**3. Bob's Sandbox Setup**
*Steps:*
- *Install FLARE VM or Cuckoo:* Set up the environment.
- *Configure virtual machines:* Use VirtualBox or VMware.
- *Install required dependencies:* Python, Yara, etc.
- *Network isolation:* Ensure the analysis machine is isolated.
- *Disable security software:* Prevent interference during analysis.
- *Load malware samples carefully:* Ensure the environment is secured.
- *Run the sandbox:* Start the analysis tool and monitor behavior.

**4. Cuckoo Sandbox Report** (Lab03-01.exe)
![alt text](ScreenShots/csc-466-a3-q4-1.png)
![alt text](ScreenShots/csc-466-a3-q4-2.png)
- *Static analysis:* Gives a summary of the file.
- *Extracted artifacts:* PoisonOvy1, RAT_PoisonIvy.
- *Behavior analysis:* Looks to be a virus of some type

**5. ProcMon Filtering for Lab03-01.exe**
Before any .exe are run.
![alt text](ScreenShots/csc-466-a3-q5-1.png)
After the Lab03-01.exe is running.
![alt text](ScreenShots/csc-466-a3-q5-3.png)

**6. Network Connections Using ProcMon**
I did not see any operations that did anything with the network.
- It could be that the process does not do anything with the network.
- or It could be that it needs to be in a certent state to preform network operations. 

**7. Registry Operations in ProcMon**
![alt text](ScreenShots/csc-466-a3-q7-1.png)
*Total = 24*

**8. Created Process Path for Lab03-01.exe**
![alt text](ScreenShots/csc-466-a3-q8-1.png)
Full address: 
```
C:\Windows\SysWOW64\WerFault.exe
```
**9. Process Creation by Lab03-01.exe**
![alt text](ScreenShots/csc-466-a3-q8-1.png)
*PID: 1348*

**10. Parent and Child Processes in ProcMon**
![alt Text](ScreenShots/csc-466-a3-q10-1.png)
Yes it did spawn a child whose *PID: 2964*

**11. Network Connections for Lab03-03.exe and Lab03-04.exe**
![alt Text](ScreenShots/csc-466-a3-q11-1.png)
I did not see any operations that did anything with the network.
- It could be that the process does not do anything with the network.
- or It could be that it needs to be in a certent state to preform network operations. 
- or I did not capture any of the processes related to network.

**12. Windows API Calls**
<u>*API Call:*</u>
- An *API* (*Application Programming Interface*) call in Windows is a way for applications or malware to interact with the operating system by requesting services like file manipulation, process management, or network communication.

<u>*Importance in Dynamic Malware Analysis:*</u>
- Understanding malware behavior: API calls allow analysts to track exactly what actions the malware is taking on the system, such as file creation, registry modifications, or network connections.
- Identifying malicious activity: Many malware types use common Windows APIs to perform harmful actions (e.g., CreateFile to drop files, RegSetValueEx to modify the registry).
- Detecting stealth techniques: Malware may use API calls to hide its behavior, such as calling NtCreateSection for process hollowing.

**13. Reproduce API Logger Experiment**

Was unable to complete the THM VM download.

**14. Process Explorer Tasks**
<u>*Task 1: Check Loaded DLLs*</u>
- *Process Explorer shows the loaded DLLs:* You can view which libraries are being used by a specific process. This helps identify if any suspicious or malicious DLLs are injected into the process.
![alt text](ScreenShots/csc-466-a3-q14-1.png)
- *Justification:* Loaded DLLs can indicate malicious injection, which is a common technique used by malware to manipulate legitimate processes.

<u>*Task 2: Inspect Process Memory Usage*</u>
- *Process Explorer shows memory consumption:* This can reveal any abnormal memory spikes, which might indicate malicious behavior like process hollowing.
![alt text](ScreenShots/csc-466-a3-q14-2.png)
- *Justification:* High memory usage might be a sign of malicious processes, such as resource-intensive malware encrypting files or communicating over the network.

**15. Process Masquerading vs. Process Hollowing**

*Process Masquerading:* This technique involves renaming a malicious process to appear as a legitimate one to avoid detection (e.g., renaming malware to explorer.exe).
*Process Hollowing:* Involves replacing the code of a legitimate process with malicious code while keeping the original process running.

*Practical Task: Process Hollowing*
- *Steps:*
    - Open Process Explorer and monitor a suspicious process.
    - Identify a legitimate process like svchost.exe with unusual activity.
    - Use Process Explorer to view its memory or executable path to confirm if itâ€™s been hollowed out.
- *Justification:*
    - *Detection of hidden malware:* Process hollowing allows malware to run under the guise of a legitimate process.
    - *Practical Example:* Identifying that svchost.exe was used by malware by analyzing its loaded memory segments.

**16. Regshot for Registry Changes**
![alt text](ScreenShots/csc-466-a3-q16-1.png)